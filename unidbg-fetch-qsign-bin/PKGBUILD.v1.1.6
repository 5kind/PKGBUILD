# Maintainer: 5kind <shikabane320@gmail.com>

_pkgname=unidbg-fetch-qsign
pkgname=${_pkgname}-bin
pkgver=1.1.6
_qqver=8.9.63
pkgrel=1
pkgdesc="获取QQSign参数通过Unidbg，开放HTTP API。"
arch=('any')
url="https://github.com/fuqiuluo/unidbg-fetch-qsign"
license=('GPL3')
depends=('java-environment>=8')
source=(
    "${url}/releases/download/${pkgver}/${_pkgname}-${pkgver}.zip"
    "${_pkgname}.service"
    "${_pkgname}@.service"
    )
sha256sums=(
    'd71669eb84d9a137ad4772f2b6fd52a67f039e66f4364f327c9d4dafe0d03e96'
    '1e0d72db6607f406a3a37bb1a4449e1a3002d80a02921447f0aebfaff88fbdb6'
    'c1ae09524a31458bb64e3cebb884b76fc40a0066b9011431d3f9437c94171b08'
    )


package() {
  cd "${pkgdir}"
  mkdir -p "opt" "usr/lib/systemd/system"
  cp -r "${srcdir}/${_pkgname}-${pkgver}" "opt/${_pkgname}"

  mkdir -p "opt/${_pkgname}/txlib"
  cd "opt/${_pkgname}/txlib"
  ln -s "${_qqver}" "current"

  cd "${pkgdir}/usr/lib/systemd/system"
  install -Dm644 "${srcdir}/${_pkgname}.service" "${_pkgname}.service"
  install -Dm644 "${srcdir}/${_pkgname}@.service" "${_pkgname}@.service"
}
