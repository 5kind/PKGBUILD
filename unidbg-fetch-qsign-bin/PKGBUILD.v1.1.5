# Maintainer: 5kind <shikabane320@gmail.com>

_pkgname=unidbg-fetch-qsign
pkgname=${_pkgname}-bin
pkgver=1.1.5
_qqver=8.9.63
pkgrel=1
pkgdesc="获取QQSign参数通过Unidbg，开放HTTP API。"
arch=('any')
url="https://github.com/fuqiuluo/unidbg-fetch-qsign"
license=('GPL3')
depends=('java-environment>=8')
backup=("opt/unidbg-fetch-qsign/txlib/current/config.json")
source=(
    "${url}/releases/download/${pkgver}/qsign-${pkgver}.zip"
    "${_pkgname}.service"
    "${_pkgname}@.service"
    )
sha256sums=(
    'cff648ecb4c90afa7f961d7656f2fbb5a2c393c27d7cdb24196aaaeba4e7d569'
    '1e0d72db6607f406a3a37bb1a4449e1a3002d80a02921447f0aebfaff88fbdb6'
    'c1ae09524a31458bb64e3cebb884b76fc40a0066b9011431d3f9437c94171b08'
    )


package() {
  cd "${pkgdir}"
  mkdir -p "opt" "usr/lib/systemd/system"
  cp -r "${srcdir}/${_pkgname}-${pkgver}" "opt/${_pkgname}"

  mkdir -p "opt/${_pkgname}/txlib"
  cd "opt/${_pkgname}/txlib"
  ln -s "${_qqver}" "current"

  cd "${pkgdir}/usr/lib/systemd/system"
  install -Dm644 "${srcdir}/${_pkgname}.service" "${_pkgname}.service"
  install -Dm644 "${srcdir}/${_pkgname}@.service" "${_pkgname}@.service"
}
